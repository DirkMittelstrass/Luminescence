---
title: "How to Analyse Al$_{2}$O$_{3}$:C Measurements"
author: "Sebastian Kreutzer"
date: "`r Sys.Date()`"
output: 
  pdf_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---

# Scope
The package 'Luminescence' offers three distinct functions dealing with the analysis of Al$_{2}$O$_{3}$:C pellet measurements:

1. `analyse_Al2O3C_ITC()`
2. `analyse_Al2O3C_CrossTalk()`
3. `analyse_Al2O3C_Measurement()`

Only the last function is really needed to routinely estimate the (environmental $\gamma$-) dose the pellet had received. However, the first two functions are needed to determine and later correct for equipment related issues. If you have already performed the
first two analysis or you do not feel the need for them, you can direclty start with the last section.

The following tutorial assumes that all measurements have been performed on a Freiberg Instruments *lexsyg SMART* luminescence reader (Richter et al., 2015). However, the general procedure should work also for a Risø TL/OSL reader. 

Please further note that this vignette covers only the **R** releated part of the data analysis and will 
not explain the theoretical and physical background. Please see XXXX for details. 

# Determine irradiation time correction factors

## Data import
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(Luminescence)
temp <- read_XSYG2R("~/Lumi/Bordeaux/Al2O3_Test/XSYG/Manuscript/2017-03-22_20170302_Al2O3_MDL.xsyg", fastForward = TRUE, txtProgressBar = FALSE) %>%
  get_RLum(recordType = "OSL (UVVIS)", drop = FALSE)
data_ITC <- temp[[1]]

temp_CT <- read_XSYG2R("~/Lumi/Bordeaux/Al2O3_Test/XSYG/Manuscript/", fastForward = TRUE, pattern = "CrossTalk_NEW",
  txtProgressBar = FALSE) %>%
  get_RLum(recordType = "OSL (UVVIS)", drop = FALSE)
data_CT <- temp_CT

temp_CAL_info <- read_XSYG2R("~/Lumi/Bordeaux/Al2O3_Test/XSYG/Manuscript/", import = FALSE, pattern = "Calibration")
```

To determine the irradiation time correction factor the function `analyse_Al2O3C_ITC()` is used. The measurement 
sequence is based on the suggestions made by XXXXX. To import the measurement data run the function 
'read_XSYG2R()` and select the measured curves, in our example 'UVVIS'.

```{r,eval = FALSE}
library(Luminescence)
data_ITC <- read_XSYG2R("MyIrradiationTimeCorrectionMeasurement.XSYG", fastForward = TRUE) %>%
  get_RLum(recordType = "OSL (UVVIS)", drop = FALSE)
data_ITC
```

```{r, echo=FALSE, R.options=list(width = 10)}
data_ITC
```

## Run analysis

The imported data are either a single `RLum.Analysis` object or a `list` of such objects, which can 
be directly passed to the function `analyse_Al2O3C_ITC()`. 

*Please note that if you follow the suggestions by XXXX no further arguments are necessary.*
\newline{}

```{r Fig1, fig.cap="Dose response curve used to correct the irradiation time for the movement duration of the sample carrier.", out.width=".8\\linewidth", fig.align="center"}
results_ITC <- analyse_Al2O3C_ITC(object = data_ITC)
```

The analysis returns a plot (Fig.\ref{fig:Fig1}) and the output is stored in the object `results_ITC` and can be used later.  
\clearpage{}

# Estimate irradiation crosstalk

## Data import

The data import is similar to the data import stated above. 

```{r,eval = FALSE}
library(Luminescence)
data_CT <- read_XSYG2R("MyCrossTalkIrradiationMeasurement.XSYG", fastForward = TRUE) %>%
  get_RLum(recordType = "OSL (UVVIS)", drop = FALSE)
data_CT
```

```{r, echo=FALSE, R.options=list(width = 10)}
data_CT[[1]]
```

## Data analysis

For the data analysis the function `analyse_Al2O3C_CrossTalk()` is called. Amongst others the function 
holds one parameter `irradiation_time_correction`. This parameter can be left empty or the 
results from the previous irradiation time correction measurements can be direclty passed to the 
function. Graphical results are shown in Fig.$~$\ref{fig:Fig2}. The numerical output is again 
an `RLum.Results` object which can be kept for a later usage. 

```{r, Fig2, fig.cap="Graphical function output of the crosstalk data analysis.", out.width=".5\\linewidth", fig.align="center", fig.height=6.5, fig.width=8, fig.pos="h"}
results_CT <- analyse_Al2O3C_CrossTalk(
  object = data_CT,
  irradiation_time_correction = results_ITC)
```

\clearpage{}

# Al$_{2}$O$_{3}$:C dose determination

This section describes the workflow for the final apparent dose estimation of the Al$_{2}$O$_{3}$ pellet. 
The analyses done above are not necessary, but recommended to correct for the equipement characteristics. 

# Data import



# Ease your workflow

# References

Richter, D., Richter, A., Dornich, K., 2015. Lexsyg smart — a luminescence detection system for dosimetry, material research and dating application. Geochronometria 42, 202–209. doi:10.1515/geochr-2015-0022
