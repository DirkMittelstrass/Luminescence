<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to analyse post-IR IRSL measurements? • Luminescence</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to analyse post-IR IRSL measurements?">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1.9000.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How to analyse post-IR IRSL measurements?</h1>
                        <h4 class="author">Sebastian Kreutzer, IRAMAT-CRP2A, UMR 5060, CNRS - Université Bordeaux Montagine, France</h4>
            
            <h4 class="date">Last modified: 2019-05-03 (‘Luminescence’ version: 0.9.1.9000.11)</h4>
      
      
      <div class="hidden name"><code>HowTo_analyse_pIRIRMeasurements.Rmd</code></div>

    </div>

    
    
<div id="scope-and-introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#scope-and-introduction" class="anchor"></a>Scope and introduction</h1>
<p>Using the function <code><a href="../reference/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL()</a></code> are <code><a href="../reference/Analyse_SAR.OSLdata.html">Analyse_SAR.OSLdata()</a></code> from the <strong>R</strong> package ‘Luminescence’ allows to analyse standard OSL (quartz) measurements based on the SAR protocol <span class="citation">(Murray and Wintle 2000)</span>.</p>
<p>The function <code><a href="../reference/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL()</a></code> can also be used for analysing measurements based on the post-IR IRSL protocol (pIRIR, <span class="citation">Thomsen et al. (2008)</span>), since the measurement protocol based on the SAR structure (see the following table) comprising a set of curves with a <span class="math inline">\(L_{x}\)</span> and <span class="math inline">\(T_{x}\)</span> signal pattern.</p>
<table class="table">
<thead><tr class="header">
<th>Step</th>
<th>Example</th>
<th>Signal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="even">
<td>Heating</td>
<td>preheat/TL</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Stimulation</td>
<td>OSL</td>
<td><span class="math inline">\(L_x\)</span></td>
</tr>
<tr class="even">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Heating</td>
<td>cutheat/TL</td>
<td>-</td>
</tr>
<tr class="even">
<td>Stimulation</td>
<td>OSL</td>
<td><span class="math inline">\(T_x\)</span></td>
</tr>
</tbody>
</table>
<p>To lower the entry level and make the analysis of post-IR IRSL data more straightforward, some time ago, the function <code><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence()</a></code> was developed. This function is basically a wrapper around the two functions <code><a href="../reference/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL()</a></code> and <code><a href="../reference/plot_GrowthCurve.html">plot_GrowthCurve()</a></code>.</p>
<p>This vignette provides a short tutorial exemplifying the analysis of post-IR IRSL data in <strong>R</strong>. To avoid misunderstandings, please keep in mind that the post-IR IRSL protocol is a simple extension of the SAR structure by introducing further stimulations steps only:</p>
<table class="table">
<thead><tr class="header">
<th>Step</th>
<th>Example</th>
<th>Signal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="even">
<td>Heating</td>
<td>preheat/TL</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Stimulation</td>
<td>IR<span class="math inline">\(_{50}\)</span>
</td>
<td><span class="math inline">\(L_{x_{_1}}\)</span></td>
</tr>
<tr class="even">
<td>Stimulation</td>
<td>pIRIR<span class="math inline">\(_{225}\)</span>
</td>
<td><span class="math inline">\(L_{x_{_2}}\)</span></td>
</tr>
<tr class="odd">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="even">
<td>Heating</td>
<td>preheat/TL</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Stimulation</td>
<td>IR<span class="math inline">\(_{50}\)</span>
</td>
<td><span class="math inline">\(T_{x_{_1}}\)</span></td>
</tr>
<tr class="even">
<td>Stimulation</td>
<td>pIRIR<span class="math inline">\(_{225}\)</span>
</td>
<td><span class="math inline">\(T_{x_{_2}}\)</span></td>
</tr>
</tbody>
</table>
<p>While the number of IRSL stimulation steps is not limited in general (cf. <span class="citation">Fu, Li, and Li (2012)</span>), the number of steps used for recording the signal of interest and the test dose signal must be equal. Example, if the sequence has two stimulation steps for the signal (<span class="math inline">\(L_{x_{_1}}\)</span>, <span class="math inline">\(L_{x_{_2}}\)</span>) (as in the table given above), it also needs two stimulations steps for measuring the test dose. Further steps, e.g., hot bleach steps at the end of the cycle, are allowed, but <strong>do not</strong> belong to the SAR structure and should be removed prior any analysis using the function <code><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence()</a></code>.</p>
<p><em>Note: The terminal and graphical output show below is partly truncated to shorten the length of this vignette, however, calling the functions in R will show the full output.</em></p>
</div>
<div id="running-example" class="section level1">
<h1 class="hasAnchor">
<a href="#running-example" class="anchor"></a>Running example</h1>
<p>In our example, the measurement was carried out on a Freiberg Instruments lexsyg luminescence reader. Measurement data are stored in XML-based file format called <em>XSYG</em>. Two pIRIR signals were measured: A IR<span class="math inline">\(_{50}\)</span> and a pIRIR<span class="math inline">\(_{225}\)</span> signal. The preheat steps were carried out as TL.</p>
<div id="data-import" class="section level2">
<h2 class="hasAnchor">
<a href="#data-import" class="anchor"></a>Data import</h2>
<p>To start with, the package ‘Luminescence’ itself has to be loaded. In a next step, measurement data are imported using the function <code><a href="../reference/read_XSYG2R.html">read_XSYG2R()</a></code>. If your input format is a BIN/BINX-file, replace the function <code><a href="../reference/read_XSYG2R.html">read_XSYG2R()</a></code> by <code><a href="../reference/read_BIN2R.html">read_BIN2R()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Luminescence)</a>
<a class="sourceLine" id="cb1-2" title="2">temp &lt;-<span class="st">  </span><span class="kw"><a href="../reference/read_XSYG2R.html">read_XSYG2R</a></span>(<span class="st">"pIRIR_measurementData.xsyg"</span>, <span class="dt">fastForward =</span> <span class="ot">TRUE</span>, <span class="dt">txtProgressBar =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>To se the dataset in the <strong>R</strong> terminal, just call the object <code>temp</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">temp</a></code></pre></div>
<pre><code>## [[1]]
## 
##  [RLum.Analysis-class]
##   originator: read_XSYG2R()
##   protocol: pIRIR225
##   additional info elements:  0
##   number of records: 229
##   .. : RLum.Data.Curve : 229
##   .. .. : #1 TL (UVVIS) &lt;&gt; #2 TL (NA) &lt;&gt; #3 TL (NA) 
##   .. .. : #4 IRSL (UVVIS) &lt;&gt; #5 IRSL (NA) &lt;&gt; #6 IRSL (NA) &lt;&gt; #7 IRSL (NA) &lt;&gt; #8 IRSL (NA)
##   .. .. : #9 IRSL (UVVIS) &lt;&gt; #10 IRSL (NA) &lt;&gt; #11 IRSL (NA) &lt;&gt; #12 IRSL (NA) &lt;&gt; #13 IRSL (NA) 
##   .. .. : #14 irradiation (NA)
##   .. .. : #15 TL (UVVIS) &lt;&gt; #16 TL (NA) &lt;&gt; #17 TL (NA) 
##   .. .. : #18 IRSL (UVVIS) &lt;&gt; #19 IRSL (NA) &lt;&gt; #20 IRSL (NA) &lt;&gt; #21 IRSL (NA) &lt;&gt; #22 IRSL (NA)
##   .. .. : #23 IRSL (UVVIS) &lt;&gt; #24 IRSL (NA) &lt;&gt; #25 IRSL (NA) &lt;&gt; #26 IRSL (NA) &lt;&gt; #27 IRSL (NA) 
## ... &lt;remaining records truncated manually&gt;</code></pre>
<p>The output shows an <code>RLum.Analysis</code> object, which contains all recorded curves (<code>RLum.Data.Curve</code> objects) from one aliquot (e.g., cup/disc). In total, the dataset contains the curves of 7 aliquots. All records are numbered, here from <code>#1</code> to <code>#208</code> (shown only until <code>#29</code>) and named by their corresponding record type (<code>TL</code>, <code>IRSL</code>). So far available, within round brackets, information on the detector are given (<code>UVVIS</code> and <code>NA</code>). This reveals that the object contains curves which are not wanted for the analysis.</p>
<p>Curves which belong to a specific measurement step (e.g., IRSL stimulation) are connected with the <code>&lt;&gt;</code> symbol. However, curves with <code>(NA)</code> are curves recorded by technical components (e.g., temperature sensor) other than the photomultiplier tube and not wanted, even they belong to the dataset. In our case, unfortunately, the information <code>(UVVIS)</code> is rather uninformative, but a usual case, since <em>it depends on the measurement device whether information on the detector are available or not.</em> This example emphasises that prior knowledge of the data structure and the used technical components are indispensable.</p>
</div>
<div id="select-wanted-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#select-wanted-curves" class="anchor"></a>Select wanted curves</h2>
<p>To select only wanted curves wanted for the analysis the function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> can be used:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">temp_sel &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_RLum.html">get_RLum</a></span>(temp, <span class="dt">recordType =</span> <span class="st">"UVVIS"</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">temp_sel</a></code></pre></div>
<pre><code>## [[1]]
## 
##  [RLum.Analysis-class]
##   originator: read_XSYG2R()
##   protocol: pIRIR225
##   additional info elements:  0
##   number of records: 49
##   .. : RLum.Data.Curve : 49
##   .. .. : #1 TL (UVVIS) | #2 IRSL (UVVIS) | #3 IRSL (UVVIS) | #4 TL (UVVIS) | #5 IRSL (UVVIS) | #6 IRSL (UVVIS) | #7 IRSL (UVVIS)
##   .. .. : #8 TL (UVVIS) | #9 IRSL (UVVIS) | #10 IRSL (UVVIS) | #11 TL (UVVIS) | #12 IRSL (UVVIS) | #13 IRSL (UVVIS) | #14 IRSL (UVVIS)
## ... &lt;remaining records truncated manually&gt;</code></pre>
<p>The function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> is very powerful and supports sophisticated subsetting of a <code>RLum.Analysis</code> objects. Further useful arguments are <code>curveType</code> and <code>record.id</code>. The latter one allows a subsetting by record id (e.g., <code>record.id = 2</code> to select <code>#2</code>) and supports also negative subsetting (e.g., to remove only <code>#2</code>, type <code>record.id = -2</code>). To understand the meaning of the argument <code>drop = FALSE</code>, please call the function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> another time with <code>drop = TRUE</code> and see the difference in the <strong>R</strong> terminal. For all supported arguments see the manual of the function by typing <code><a href="../reference/get_RLum.html">?get_RLum</a></code> in the <strong>R</strong> terminal.</p>
<p>In our example, however, the dataset does not yet follow the SAR structure. The sequence comprises a hotbleach at the end of each cycles (record <code>#7</code> in the terminal output example above). This curves are not wanted a have to be removed. This can be done using again the function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> with the argument <code>record.id</code>. Please note that by executing the following example the object <code>temp_sel</code> will be replaced.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">temp_sel &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_RLum.html">get_RLum</a></span>(temp_sel, <span class="dt">record.id =</span> <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">7</span>,<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(temp_sel[[<span class="dv">1</span>]]), <span class="dt">by =</span> <span class="dv">7</span>), <span class="dt">drop =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">temp_sel</a></code></pre></div>
<pre><code>## [[1]]
## 
##  [RLum.Analysis-class]
##   originator: read_XSYG2R()
##   protocol: pIRIR225
##   additional info elements:  0
##   number of records: 42
##   .. : RLum.Data.Curve : 42
##   .. .. : #1 TL (UVVIS) | #2 IRSL (UVVIS) | #3 IRSL (UVVIS) | #4 TL (UVVIS) | #5 IRSL (UVVIS) | #6 IRSL (UVVIS) | #7 TL (UVVIS)
##   .. .. : #8 IRSL (UVVIS) | #9 IRSL (UVVIS) | #10 TL (UVVIS) | #11 IRSL (UVVIS) | #12 IRSL (UVVIS) | #13 TL (UVVIS) | #14 IRSL (UVVIS)
## ... &lt;remaining records truncated manually&gt;</code></pre>
<p>Using a negative subsetting, all hotbleach curves have been removed using the call <code>-seq(7,length(temp_sel[[1]]), by = 7)</code>. Important is to understand that the function <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> was called for the first list element of <code>temp_sel</code>, which contains the recorded curves for the first aliquot only. To see the differences type:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(temp_sel)</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(temp_sel[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## [1] 42</code></pre>
<p>In other words, our measurement record has data from 7 aliquots and each aliquot consits of (at least) 42 records. We here further assume that the number of records is similar for each aliquot.</p>
</div>
</div>
<div id="analyse-sequence" class="section level1">
<h1 class="hasAnchor">
<a href="#analyse-sequence" class="anchor"></a>Analyse sequence</h1>
<p>Now the object <code>temp_sel</code> only comprises TL and IRSL curves, and this data can be directly passed to the function <code><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence</a></span>(</a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="dt">object =</span> temp_sel[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="dt">signal.integral.min =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="dt">signal.integral.max =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="dt">background.integral.min =</span> <span class="dv">800</span>, </a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="dt">background.integral.max =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb14-7" title="7">  <span class="dt">dose.points =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">340</span>, <span class="dv">680</span>, <span class="dv">1020</span>, <span class="dv">1360</span>, <span class="dv">0</span>, <span class="dv">340</span>),</a>
<a class="sourceLine" id="cb14-8" title="8">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="HowTo_analyse_pIRIRMeasurements_files/figure-html/unnamed-chunk-12-1.png" width="700" height="400px" style="display: block; margin: auto;"></p>
<p>The function expects the setting of some arguments, for details and meaning, please see <code><a href="../reference/analyse_pIRIRSequence.html">?analyse_pIRIRSequence</a></code>. If the imported measurement data do not carry information on the <code>dose.points</code>, as it is the case in our example, these values have to be provided manually. Please note that the information needed for <code>dose.points</code> is something which was defined while writing the measurement sequence (your irradiation times).</p>
<p>The function output is a comprehensive plot scheme and a so-called <code>RLum.Results</code> object, which contains all relevant calculations from the analysis.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">results</a></code></pre></div>
<pre><code>## 
##  [RLum.Results-class]
##   originator: analyse_pIRIRSequence()
##   data: 4
##       .. $data : data.frame
##   .. $LnLxTnTx.table : data.frame
##   .. $rejection.criteria : data.frame
##   .. $Formula : list
##   additional info elements:  14</code></pre>
<p>The <span class="math inline">\(D_{e}\)</span> values (here in seconds) can be seen by calling the <code>$data</code> element from the object <code>results</code>, which is a <code>data.frame</code> (and here limited to three columns):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">results<span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"De"</span>, <span class="st">"De.Error"</span>, <span class="st">"RC.Status"</span>, <span class="st">"Signal"</span>)]</a></code></pre></div>
<pre><code>##         De De.Error RC.Status   Signal
## 1   803.54    39.61        OK     IR50
## 2  1099.86    29.48        OK pIRIR225
## 3   632.80    29.11        OK     IR50
## 4   873.77    26.87        OK pIRIR225
## 5  1166.26    31.64        OK     IR50
## 6  1058.84    19.38        OK pIRIR225
## 7   741.30    31.15    FAILED     IR50
## 8  1049.17    24.01        OK pIRIR225
## 9   873.96    59.36        OK     IR50
## 10 1236.34    55.16        OK pIRIR225
## 11  827.68    42.09        OK     IR50
## 12 1095.24    34.96        OK pIRIR225
## 13  714.12    23.56        OK     IR50
## 14  807.30    17.00        OK pIRIR225</code></pre>
<p>The column <code>RC.Status</code> informs you about a failed rejection criterium, which one is not revealed, but the column provides a possibilty for further subsetting. For a quick data processing this is, together with the plot output, usually enough information. However, to see all rejection criteria type <code>results$rejection.criteria</code>. To see all information type <code>results$data</code> without further information.</p>
<p>If you want to combine the two tables for a more virtous data processing, you can merge both tables by calling:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(results<span class="op">$</span>data, results<span class="op">$</span>rejection.criteria, <span class="dt">by =</span> <span class="st">"UID"</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df)</a></code></pre></div>
<pre><code>##                                   UID      De De.Error     D01 D01.ERROR
## 1 2019-05-03-07:12.0.0301973617170006 1166.26    31.64 2185.14  231.2947
## 2 2019-05-03-07:12.0.0301973617170006 1166.26    31.64 2185.14  231.2947
## 3 2019-05-03-07:12.0.0301973617170006 1166.26    31.64 2185.14  231.2947
## 4 2019-05-03-07:12.0.0301973617170006 1166.26    31.64 2185.14  231.2947
## 5 2019-05-03-07:12.0.0301973617170006 1166.26    31.64 2185.14  231.2947
## 6  2019-05-03-07:12.0.464417472016066  632.80    29.11 1160.62  131.4292
##   D02 D02.ERROR   De.MC Fit RC.Status signal.range background.range
## 1  NA        NA 1169.35 EXP        OK       1 : 10        800 : 999
## 2  NA        NA 1169.35 EXP        OK       1 : 10        800 : 999
## 3  NA        NA 1169.35 EXP        OK       1 : 10        800 : 999
## 4  NA        NA 1169.35 EXP        OK       1 : 10        800 : 999
## 5  NA        NA 1169.35 EXP        OK       1 : 10        800 : 999
## 6  NA        NA  631.12 EXP        OK       1 : 10        800 : 999
##   signal.range.Tx background.range.Tx Signal.x                Criteria
## 1         NA : NA             NA : NA     IR50 Recycling ratio (R5/R1)
## 2         NA : NA             NA : NA     IR50     Recuperation rate 1
## 3         NA : NA             NA : NA     IR50          Testdose error
## 4         NA : NA             NA : NA     IR50        Palaeodose error
## 5         NA : NA             NA : NA     IR50    De &gt; max. dose point
## 6         NA : NA             NA : NA     IR50 Recycling ratio (R5/R1)
##          Value Threshold Status Signal.y
## 1 9.904000e-01       0.1     OK     IR50
## 2 1.000000e-03       0.1     OK     IR50
## 3 1.533869e-02       0.1     OK     IR50
## 4 2.713000e-02       0.1     OK     IR50
## 5 1.166260e+03    1360.0     OK     IR50
## 6 1.041100e+00       0.1     OK     IR50</code></pre>
<p>The result may appear confusing in a first instance, since, e.g. the column <code>De</code> appears to contain duplicated entries. But still, each row is unique and in sum contains unique information.</p>
</div>
<div id="plot-results" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-results" class="anchor"></a>Plot results</h1>
<p>To plot the <code>pIRIR225</code> <span class="math inline">\(D_{e}\)</span> values the following call can be used:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="../reference/plot_KDE.html">plot_KDE</a></span>(</a>
<a class="sourceLine" id="cb21-2" title="2">  <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(results<span class="op">$</span>data, Signal <span class="op">==</span><span class="st"> "pIRIR225"</span>)[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"De"</span>, <span class="st">"De.Error"</span>)],</a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(D[e], <span class="st">" [s]"</span>)), </a>
<a class="sourceLine" id="cb21-4" title="4">  <span class="dt">summary =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"sd.abs"</span>)</a>
<a class="sourceLine" id="cb21-5" title="5">  )</a></code></pre></div>
<p><img src="HowTo_analyse_pIRIRMeasurements_files/figure-html/unnamed-chunk-17-1.png" width="200" style="display: block; margin: auto;"></p>
</div>
<div id="compacted-call" class="section level1">
<h1 class="hasAnchor">
<a href="#compacted-call" class="anchor"></a>Compacted call</h1>
<p>The above-listed steps can also be shortened to a concise <strong>R</strong> call using the so-called <code>magriitr</code> operator, which basically pipes the results from function to function. To have a difference the final plot is an Abanico plot <span class="citation">Dietze et al. (2016)</span>.</p>
<p><em>Please note that for this last example the arguments <code>plot</code> and <code>verbose</code> have been set to <code>FALSE</code> for most of the functions.</em></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_XSYG2R.html">read_XSYG2R</a></span>(<span class="st">"pIRIR_measurementData.xsyg"</span>, <span class="dt">fastForward =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/get_RLum.html">get_RLum</a></span>(<span class="dt">recordType =</span> <span class="st">"UVVIS"</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/get_RLum.html">get_RLum</a></span>(.,<span class="dt">record.id =</span> <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">7</span>,<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(.[[<span class="dv">1</span>]]), <span class="dt">by =</span> <span class="dv">7</span>), <span class="dt">drop =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence</a></span>(</a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="dt">signal.integral.min =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb22-6" title="6">    <span class="dt">signal.integral.max =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb22-7" title="7">    <span class="dt">background.integral.min =</span> <span class="dv">800</span>, </a>
<a class="sourceLine" id="cb22-8" title="8">    <span class="dt">background.integral.max =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb22-9" title="9">    <span class="dt">dose.points =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">340</span>, <span class="dv">680</span>, <span class="dv">1020</span>, <span class="dv">1360</span>, <span class="dv">0</span>, <span class="dv">340</span>), </a>
<a class="sourceLine" id="cb22-10" title="10">    <span class="dt">verbose =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb22-11" title="11">    <span class="dt">plot =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="st">  </span><span class="kw"><a href="../reference/get_RLum.html">get_RLum</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(.,<span class="dt">subset =</span> Signal <span class="op">==</span><span class="st"> "pIRIR225"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="st">  </span><span class="kw"><a href="../reference/plot_AbanicoPlot.html">plot_AbanicoPlot</a></span>(</a>
<a class="sourceLine" id="cb22-15" title="15">  <span class="dt">data =</span> .[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"De"</span>, <span class="st">"De.Error"</span>)],</a>
<a class="sourceLine" id="cb22-16" title="16">  <span class="dt">zlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(D[e], <span class="st">" [s]"</span>)), </a>
<a class="sourceLine" id="cb22-17" title="17">  <span class="dt">summary =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"sd.abs"</span>)</a>
<a class="sourceLine" id="cb22-18" title="18">  )</a></code></pre></div>
<p><img src="HowTo_analyse_pIRIRMeasurements_files/figure-html/unnamed-chunk-18-1.png" width="250" style="display: block; margin: auto;"></p>
<p>#References {-}</p>
<div id="refs" class="references">
<div id="ref-Dietze:2015dp">
<p>Dietze, Michael, Sebastian Kreutzer, Christoph Burow, Margret C Fuchs, Manfred Fischer, and Christoph Schmidt. 2016. “The abanico plot: visualising chronometric data with individual standard errors.” <em>Quaternary Geochronology</em> 31: 12–18.</p>
</div>
<div id="ref-Fu:2012ca">
<p>Fu, Xiao, Bo Li, and Sheng-Hua Li. 2012. “Testing a multi-step post-IR IRSL dating method using polymineral fine grains from Chinese loess.” <em>Radiation Measurements</em> 10: 8–15.</p>
</div>
<div id="ref-Murray_2000cr">
<p>Murray, A S, and Ann G Wintle. 2000. “Luminescence dating of quartz using an improved single-aliquot regenerative-dose protocol.” <em>Radiation Measurements</em> 32 (1): 57–73.</p>
</div>
<div id="ref-Thomsen_2008qv">
<p>Thomsen, K J, A S Murray, M Jain, and L Boetter-Jensen. 2008. “Laboratory fading rates of various luminescence signals from feldspar-rich sediment extracts.” <em>Radiation Measurements</em> 43 (9-10): 1474–86.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#scope-and-introduction">Scope and introduction</a></li>
      <li>
<a href="#running-example">Running example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#data-import">Data import</a></li>
      <li><a href="#select-wanted-curves">Select wanted curves</a></li>
      </ul>
</li>
      <li><a href="#analyse-sequence">Analyse sequence</a></li>
      <li><a href="#plot-results">Plot results</a></li>
      <li><a href="#compacted-call">Compacted call</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
