<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analyse SAR CW-OSL measurements — analyse_SAR.CWOSL • Luminescence</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<meta property="og:title" content="Analyse SAR CW-OSL measurements — analyse_SAR.CWOSL" />

<meta property="og:description" content="The function performs a SAR CW-OSL analysis on an
RLum.Analysis object including growth curve fitting." />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Luminescence</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/HowTo_analyse_Al2O3.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.7.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analyse SAR CW-OSL measurements</h1>
    </div>

    
    <p>The function performs a SAR CW-OSL analysis on an
<a href='RLum.Analysis-class.html'>RLum.Analysis</a> object including growth curve fitting.</p>
    

    <pre class="usage"><span class='fu'>analyse_SAR.CWOSL</span>(<span class='no'>object</span>, <span class='no'>signal.integral.min</span>, <span class='no'>signal.integral.max</span>,
  <span class='no'>background.integral.min</span>, <span class='no'>background.integral.max</span>, <span class='kw'>rejection.criteria</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>dose.points</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>mtext.outer</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>plot.single</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>onlyLxTxTable</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><a href='RLum.Analysis-class.html'>RLum.Analysis</a> (<strong>required</strong>):
input object containing data for analysis, alternatively a list of
<a href='RLum.Analysis-class.html'>RLum.Analysis</a> objects can be provided.</p></td>
    </tr>
    <tr>
      <th>signal.integral.min</th>
      <td><p>integer (<strong>required</strong>):
lower bound of the signal integral. Can be a list of integers, if <code>object</code> is
of type list. If the input is vector (e.g., <code>c(1,2)</code>) the 2nd value will be interpreted
as the minimum signal integral for the Tx curve.</p></td>
    </tr>
    <tr>
      <th>signal.integral.max</th>
      <td><p>integer (<strong>required</strong>):
upper bound of the signal integral. Can be a list of integers, if <code>object</code> is
of type list. If the input is vector (e.g., <code>c(1,2)</code>) the 2nd value will be interpreted
as the maximum signal integral for the Tx curve.</p></td>
    </tr>
    <tr>
      <th>background.integral.min</th>
      <td><p>integer (<strong>required</strong>):
lower bound of the background integral. Can be a list of integers, if <code>object</code> is
of type list. If the input is vector (e.g., <code>c(1,2)</code>) the 2nd value will be interpreted
as the minimum background integral for the Tx curve.</p></td>
    </tr>
    <tr>
      <th>background.integral.max</th>
      <td><p>integer (<strong>required</strong>):
upper bound of the background integral. Can be a list of integers, if <code>object</code> is
of type list. If the input is vector (e.g., <code>c(1,2)</code>) the 2nd value will be interpreted
as the maximum background integral for the Tx curve.</p></td>
    </tr>
    <tr>
      <th>rejection.criteria</th>
      <td><p>list (<em>with default</em>):
provide a named list and set rejection criteria in <strong>percentage</strong> for further calculation. Can be a list in
a list, if <code>object</code> is of type list</p>
<p>Allowed arguments are <code>recycling.ratio</code>, <code>recuperation.rate</code>,
<code>palaeodose.error</code>, <code>testdose.error</code> and <code>exceed.max.regpoint = TRUE/FALSE</code>.
Example: <code>rejection.criteria = list(recycling.ratio = 10)</code>.
Per default all numerical values are set to 10, <code>exceed.max.regpoint = TRUE</code>.
Every criterium can be set to <code>NA</code>. In this value are calculated, but not considered, i.e.
the RC.Status becomes always <code>'OK'</code></p></td>
    </tr>
    <tr>
      <th>dose.points</th>
      <td><p>numeric (<em>optional</em>):
a numeric vector containg the dose points values Using this argument
overwrites dose point values in the signal curves. Can be a list of
numeric vectors, if <code>object</code> is of type list</p></td>
    </tr>
    <tr>
      <th>mtext.outer</th>
      <td><p>character (<em>optional</em>):
option to provide an outer margin mtext. Can be a list of characters,
if <code>object</code> is of type list</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>logical (<em>with default</em>):
enables or disables plot output.</p></td>
    </tr>
    <tr>
      <th>plot.single</th>
      <td><p>logical (<em>with default</em>) or numeric (<em>optional</em>):
single plot output (<code>TRUE/FALSE</code>) to allow for plotting the results in single plot windows.
If a numerice vector is provided the plots can be selected individually, i.e.
<code>plot.single = c(1,2,3,4)</code> will plot the TL and Lx, Tx curves but not the legend (5) or the
growth curve (6), (7) and (8) belong to rejection criteria plots. Requires
<code>plot = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>onlyLxTxTable</th>
      <td><p>logical (with default): If <code>TRUE</code> the dose response curve fitting and plotting
is skipped. This allows to get hands on the Lx/Tx table for large datasets without the need for
a curve fitting.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments that will be passed to the function
<a href='plot_GrowthCurve.html'>plot_GrowthCurve</a> or <a href='calc_OSLLxTxRatio.html'>calc_OSLLxTxRatio</a>
(supported: <code>background.count.distribution</code>, <code>sigmab</code>, <code>sig0</code>).
<strong>Please note</strong> that if you consider to use the early light subtraction
method you should provide your own <code>sigmab</code> value!</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A plot (<em>optional</em>) and an <a href='RLum.Results-class.html'>RLum.Results</a> object is
returned containing the following elements:</p>
<dt>data</dt><dd><p>data.frame containing De-values, De-error and further parameters</p></dd>
<dt>LnLxTnTx.values</dt><dd><p>data.frame of all calculated Lx/Tx values including signal, background counts and the dose points</p></dd>
<dt>rejection.criteria</dt><dd><p>data.frame with values that might by used as rejection criteria. NA is produced if no R0 dose point exists.</p></dd>
<dt>Formula</dt><dd><p>formula formula that have been used for the growth curve fitting</p></dd>

The output should be accessed using the function get_RLum.

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function performs an analysis for a standard SAR protocol measurements
introduced by Murray and Wintle (2000) with CW-OSL curves. For the
calculation of the Lx/Tx value the function <a href='calc_OSLLxTxRatio.html'>calc_OSLLxTxRatio</a> is
used. For <strong>changing the way the Lx/Tx error is calculated</strong> use the argument
<code>background.count.distribution</code> and <code>sigmab</code>, which will be passed to the function
<a href='calc_OSLLxTxRatio.html'>calc_OSLLxTxRatio</a>.
    <strong>Argument <code>object</code> is of type <code>list</code></strong></p>
<p>If the argument <code>object</code> is of type list containing <strong>only</strong>
<a href='RLum.Analysis-class.html'>RLum.Analysis</a> objects, the function re-calls itself as often as elements
are in the list. This is usefull if an entire measurement wanted to be analysed without
writing separate for-loops. To gain in full control of the parameters (e.g., <code>dose.points</code>) for
every aliquot (corresponding to one <a href='RLum.Analysis-class.html'>RLum.Analysis</a> object in the list), in
this case the arguments can be provided as list. This <code>list</code> should
be of similar length as the <code>list</code> provided with the argument <code>object</code>,
otherwise the function will create an own list of the requested lenght.
Function output will be just one single <a href='RLum.Results-class.html'>RLum.Results</a> object.</p>
<p>Please be careful when using this option. It may allow a fast an efficient data analysis, but
the function may also break with an unclear error message, due to wrong input data.
    <strong>Working with IRSL data</strong></p>
<p>The function was originally designed to work just for 'OSL' curves,
following the principles of the SAR protocol. An IRSL measurement protocol
may follow this procedure, e.g., post-IR IRSL protocol (Thomsen et al.,
2008). Therefore this functions has been enhanced to work with IRSL data,
however, the function is only capable of analysing curves that follow the
SAR protocol structure, i.e., to analyse a post-IR IRSL protocol, curve data
have to be pre-selected by the user to fit the standards of the SAR
protocol, i.e., Lx,Tx,Lx,Tx and so on.</p>
<p>Example: Imagine the measurement contains pIRIR50 and pIRIR225 IRSL curves.
Only one curve type can be analysed at the same time: The pIRIR50 curves or
the pIRIR225 curves.
    <strong>Supported rejection criteria</strong>
    <code>[recycling.ratio]</code>: calculated for every repeated regeneration dose point.
    <code>[recuperation.rate]</code>: recuperation rate calculated by comparing the
Lx/Tx values of the zero regeneration point with the Ln/Tn value (the Lx/Tx
ratio of the natural signal). For methodological background see Aitken and
Smith (1988).
    <code>[testdose.error]</code>: set the allowed error for the testdose, which per
default should not exceed 10%. The testdose error is calculated as Tx_net.error/Tx_net.
    <code>[palaeodose.error]</code>: set the allowed error for the De value, which per
default should not exceed 10%.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function must not be mixed up with the function
<a href='Analyse_SAR.OSLdata.html'>Analyse_SAR.OSLdata</a>, which works with
<a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a> objects.
    <strong>The function currently does only support 'OSL' or 'IRSL' data!</strong></p>
    
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.8.0 (2018-01-31 17:56:43)</p>
    
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S. (2018). analyse_SAR.CWOSL(): Analyse SAR CW-OSL measurements. Function version 0.8.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J. (2018). Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.8.1. https://CRAN.R-project.org/package=Luminescence</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Aitken, M.J. and Smith, B.W., 1988. Optical dating: recuperation
after bleaching. Quaternary Science Reviews 7, 387-393.</p>
<p>Duller, G., 2003. Distinguishing quartz and feldspar in single grain
luminescence measurements. Radiation Measurements, 37 (2), 161-165.</p>
<p>Murray, A.S. and Wintle, A.G., 2000. Luminescence dating of quartz using an
improved single-aliquot regenerative-dose protocol. Radiation Measurements
32, 57-73.</p>
<p>Thomsen, K.J., Murray, A.S., Jain, M., Boetter-Jensen, L., 2008. Laboratory
fading rates of various luminescence signals from feldspar-rich sediment
extracts. Radiation Measurements 43, 1474-1486.
doi:10.1016/j.radmeas.2008.06.002</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><a href='calc_OSLLxTxRatio.html'>calc_OSLLxTxRatio</a>, <a href='plot_GrowthCurve.html'>plot_GrowthCurve</a>, <a href='RLum.Analysis-class.html'>RLum.Analysis</a>,
<a href='RLum.Results-class.html'>RLum.Results</a>, <a href='get_RLum.html'>get_RLum</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>##load data</span>
<span class='co'>##ExampleData.BINfileData contains two BINfileData objects</span>
<span class='co'>##CWOSL.SAR.Data and TL.SAR.Data</span>
<span class='fu'>data</span>(<span class='no'>ExampleData.BINfileData</span>, <span class='kw'>envir</span> <span class='kw'>=</span> <span class='fu'>environment</span>())

<span class='co'>##transform the values from the first position in a RLum.Analysis object</span>
<span class='no'>object</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Risoe.BINfileData2RLum.Analysis.html'>Risoe.BINfileData2RLum.Analysis</a></span>(<span class='no'>CWOSL.SAR.Data</span>, <span class='kw'>pos</span><span class='kw'>=</span><span class='fl'>1</span>)

<span class='co'>##perform SAR analysis and set rejection criteria</span>
<span class='no'>results</span> <span class='kw'>&lt;-</span> <span class='fu'>analyse_SAR.CWOSL</span>(
<span class='kw'>object</span> <span class='kw'>=</span> <span class='no'>object</span>,
<span class='kw'>signal.integral.min</span> <span class='kw'>=</span> <span class='fl'>1</span>,
<span class='kw'>signal.integral.max</span> <span class='kw'>=</span> <span class='fl'>2</span>,
<span class='kw'>background.integral.min</span> <span class='kw'>=</span> <span class='fl'>900</span>,
<span class='kw'>background.integral.max</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
<span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"x"</span>,
<span class='kw'>fit.method</span> <span class='kw'>=</span> <span class='st'>"EXP"</span>,
<span class='kw'>rejection.criteria</span> <span class='kw'>=</span> <span class='fu'>list</span>(
  <span class='kw'>recycling.ratio</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>recuperation.rate</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>testdose.error</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>palaeodose.error</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>exceed.max.regpoint</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
)</div><div class='img'><img src='analyse_SAR.CWOSL-1.png' alt='' width='700' height='432.632880098887' /></div><div class='output co'>#&gt; [plot_GrowthCurve()] Fit: EXP (interpolation) | De = 1668.25 | D01 = 1982.76</div><div class='img'><img src='analyse_SAR.CWOSL-2.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'>##show De results</span>
<span class='fu'><a href='get_RLum.html'>get_RLum</a></span>(<span class='no'>results</span>)</div><div class='output co'>#&gt;        De De.Error     D01 D01.ERROR D02 D02.ERROR   De.MC Fit RC.Status
#&gt; 1 1668.25    45.49 1982.76  106.9878  NA        NA 1671.77 EXP        OK
#&gt;   signal.range background.range signal.range.Tx background.range.Tx
#&gt; 1        1 : 2       900 : 1000         NA : NA             NA : NA
#&gt;                                  UID
#&gt; 1 2018-02-27-03:58.0.142552352277562</div><div class='input'>
<span class='co'>##show LnTnLxTx table</span>
<span class='fu'><a href='get_RLum.html'>get_RLum</a></span>(<span class='no'>results</span>, <span class='kw'>data.object</span> <span class='kw'>=</span> <span class='st'>"LnLxTnTx.table"</span>)</div><div class='output co'>#&gt;      Name Repeated Dose  LnLx   LnLx.BG TnTx   TnTx.BG    Net_LnLx
#&gt; 1 Natural    FALSE    0 20391  60.15842 4771  73.50495 20330.84158
#&gt; 2      R1    FALSE  450  7591  65.70297 4977  81.56436  7525.29703
#&gt; 3      R2    FALSE 1050 15150  96.17822 4960 101.92079 15053.82178
#&gt; 4      R3    FALSE 2000 23700 118.49505 5064 121.06931 23581.50495
#&gt; 5      R4    FALSE 2550 31094 155.92079 5715 145.84158 30938.07921
#&gt; 6      R5     TRUE  450  9376 122.37624 5860 127.60396  9253.62376
#&gt; 7      R0    FALSE    0   192  94.39604 6107 117.64356    97.60396
#&gt;   Net_LnLx.Error Net_TnTx Net_TnTx.Error       LxTx  LxTx.Error
#&gt; 1      143.03415 4697.495       69.24882 4.32801767 0.070695494
#&gt; 2       87.39498 4895.436       71.06916 1.53720681 0.028578369
#&gt; 3      123.18402 4858.079       71.66840 3.09871888 0.052275097
#&gt; 4      154.46828 4942.931       72.07168 4.77075371 0.076258410
#&gt; 5      176.39564 5569.158       75.88226 5.55525214 0.082052531
#&gt; 6       97.54912 5732.396       77.37976 1.61426805 0.027647946
#&gt; 7       14.86509 5989.356       78.87190 0.01629624 0.002491179
#&gt;                                  UID
#&gt; 1 2018-02-27-03:58.0.142552352277562
#&gt; 2 2018-02-27-03:58.0.142552352277562
#&gt; 3 2018-02-27-03:58.0.142552352277562
#&gt; 4 2018-02-27-03:58.0.142552352277562
#&gt; 5 2018-02-27-03:58.0.142552352277562
#&gt; 6 2018-02-27-03:58.0.142552352277562
#&gt; 7 2018-02-27-03:58.0.142552352277562</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#function-version">Function version</a></li>

      <li><a href="#how-to-cite">How to cite</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Sebastian Kreutzer, IRAMAT-CRP2A, Universite Bordeaux Montaigne (France)
 R Luminescence Package Team
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
