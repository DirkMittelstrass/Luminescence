<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analyse post-IR IRSL measurement sequences — analyse_pIRIRSequence • Luminescence</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<meta property="og:title" content="Analyse post-IR IRSL measurement sequences — analyse_pIRIRSequence" />

<meta property="og:description" content="The function performs an analysis of post-IR IRSL sequences including curve
fitting on RLum.Analysis objects." />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Luminescence</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/HowTo_analyse_Al2O3.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.7.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analyse post-IR IRSL measurement sequences</h1>
    </div>

    
    <p>The function performs an analysis of post-IR IRSL sequences including curve
fitting on <a href='RLum.Analysis-class.html'>RLum.Analysis</a> objects.</p>
    

    <pre class="usage"><span class='fu'>analyse_pIRIRSequence</span>(<span class='no'>object</span>, <span class='no'>signal.integral.min</span>, <span class='no'>signal.integral.max</span>,
  <span class='no'>background.integral.min</span>, <span class='no'>background.integral.max</span>, <span class='kw'>dose.points</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sequence.structure</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"TL"</span>, <span class='st'>"IR50"</span>, <span class='st'>"pIRIR225"</span>), <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>plot.single</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><a href='RLum.Analysis-class.html'>RLum.Analysis</a> or list of <a href='RLum.Analysis-class.html'>RLum.Analysis</a> objects (<strong>required</strong>):
input object containing data for analysis.
If a list is provided the functions tries to iteratre over the list.</p></td>
    </tr>
    <tr>
      <th>signal.integral.min</th>
      <td><p>integer (<strong>required</strong>):
lower bound of the signal integral. Provide this value as vector for different
integration limits for the different IRSL curves.</p></td>
    </tr>
    <tr>
      <th>signal.integral.max</th>
      <td><p>integer (<strong>required</strong>):
upper bound of the signal integral. Provide this value as vector for different
integration limits for the different IRSL curves.</p></td>
    </tr>
    <tr>
      <th>background.integral.min</th>
      <td><p>integer (<strong>required</strong>):
lower bound of the background integral. Provide this value as vector for
different integration limits for the different IRSL curves.</p></td>
    </tr>
    <tr>
      <th>background.integral.max</th>
      <td><p>integer (<strong>required</strong>):
upper bound of the background integral. Provide this value as vector for
different integration limits for the different IRSL curves.</p></td>
    </tr>
    <tr>
      <th>dose.points</th>
      <td><p>numeric (<em>optional</em>):
a numeric vector containing the dose points values. Using this argument overwrites dose point
values in the signal curves.</p></td>
    </tr>
    <tr>
      <th>sequence.structure</th>
      <td><p>vector character (<em>with default</em>):
specifies the general sequence structure. Allowed values are <code>"TL"</code> and
any <code>"IR"</code> combination (e.g., <code>"IR50"</code>,<code>"pIRIR225"</code>).
Additionally a parameter <code>"EXCLUDE"</code> is allowed to exclude curves from
the analysis (Note: If a preheat without PMT measurement is used, i.e.
preheat as none TL, remove the TL step.)</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>logical (<em>with default</em>):
enables or disables plot output.</p></td>
    </tr>
    <tr>
      <th>plot.single</th>
      <td><p>logical (<em>with default</em>):
single plot output (<code>TRUE/FALSE</code>) to allow for plotting the results in single plot
windows. Requires <code>plot = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments that will be passed to the function
<a href='analyse_SAR.CWOSL.html'>analyse_SAR.CWOSL</a> and <a href='plot_GrowthCurve.html'>plot_GrowthCurve</a>. Furthermore, the arguments <code>main</code> (headers), <code>log</code> (IRSL curves), <code>cex</code> (control
the size) and <code>mtext.outer</code> (additional text on the plot area) can be passed to influence the plotting. If the input
is list, <code>main</code> can be passed as vector or list.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Plots (<em>optional</em>) and an <a href='RLum.Results-class.html'>RLum.Results</a> object is
returned containing the following elements:</p><table><tr><td>
<strong>DATA.OBJECT</strong> </td>
<td> <strong>TYPE</strong> </td>
<td> <strong>DESCRIPTION</strong> </td>
</tr><tr><td>
<code>..$data</code> : </td>
<td>  <code>data.frame</code> </td>
<td> Table with De values </td>
</tr><tr><td>
<code>..$LnLxTnTx.table</code> : </td>
<td> <code>data.frame</code> </td>
<td> with the LnLxTnTx values </td>
</tr><tr><td>
<code>..$rejection.criteria</code> : </td>
<td> data.frame </td>
<td> rejection criteria </td>
</tr><tr><td>
<code>..$Formula</code> : </td>
<td> list </td>
<td> Function used for fitting of the dose response curve </td>
</tr></table>

<p>The output should be accessed using the function <a href='get_RLum.html'>get_RLum</a>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To allow post-IR IRSL protocol (Thomsen et al., 2008) measurement analyses
this function has been written as extended wrapper function for the function
<a href='analyse_SAR.CWOSL.html'>analyse_SAR.CWOSL</a>, facilitating an entire sequence analysis in
one run. With this, its functionality is strictly limited by the
functionality of the function <a href='analyse_SAR.CWOSL.html'>analyse_SAR.CWOSL</a>.</p>
<p>**Defining the sequence structure **</p>
<p>The argument <code>sequence.structure</code> expects a shortened pattern of your sequence structure and was
mainly introduced to ease the use of the function. For example: If your measurement data contains
the following curves: <code>TL</code>, <code>IRSL</code>, <code>IRSL</code>, <code>TL</code>, <code>IRSL</code>, <code>IRSL</code>, the sequence pattern in <code>sequence.structure</code>
becomes <code>c('TL', 'IRSL', 'IRSL')</code>. The second part of your sequence for one cycle should be
similar and can be discarded. If this is not the case (e.g., additional hotbleach) such curves
have to be removed before using the function.
    <strong>If the input is a <code>list</code></strong></p>
<p>If the input is a list of RLum.Analysis-objects, every argument can be provided as list to allow
for different sets of parameters for every single input element.
For further information see <a href='analyse_SAR.CWOSL.html'>analyse_SAR.CWOSL</a>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Best graphical output can be achieved by using the function <code>pdf</code>
with the following options:
    <code>pdf(file = "...", height = 15, width = 15)</code></p>
    
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.2.4 (2018-01-28 19:53:33)</p>
    
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S. (2018). analyse_pIRIRSequence(): Analyse post-IR IRSL measurement sequences. Function version 0.2.4. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J. (2018). Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.8.1. https://CRAN.R-project.org/package=Luminescence</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Murray, A.S., Wintle, A.G., 2000. Luminescence dating of quartz
using an improved single-aliquot regenerative-dose protocol. Radiation
Measurements 32, 57-73. doi:10.1016/S1350-4487(99)00253-X</p>
<p>Thomsen, K.J., Murray, A.S., Jain, M., Boetter-Jensen, L., 2008. Laboratory
fading rates of various luminescence signals from feldspar-rich sediment
extracts. Radiation Measurements 43, 1474-1486.
doi:10.1016/j.radmeas.2008.06.002</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><a href='analyse_SAR.CWOSL.html'>analyse_SAR.CWOSL</a>, <a href='calc_OSLLxTxRatio.html'>calc_OSLLxTxRatio</a>, <a href='plot_GrowthCurve.html'>plot_GrowthCurve</a>,
<a href='RLum.Analysis-class.html'>RLum.Analysis</a>, <a href='RLum.Results-class.html'>RLum.Results</a> <a href='get_RLum.html'>get_RLum</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='co'>### NOTE: For this example existing example data are used. These data are non pIRIR data.</span>
<span class='co'>###</span>
<span class='co'>##(1) Compile example data set based on existing example data (SAR quartz measurement)</span>
<span class='co'>##(a) Load example data</span>
<span class='fu'>data</span>(<span class='no'>ExampleData.BINfileData</span>, <span class='kw'>envir</span> <span class='kw'>=</span> <span class='fu'>environment</span>())

<span class='co'>##(b) Transform the values from the first position in a RLum.Analysis object</span>
<span class='no'>object</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Risoe.BINfileData2RLum.Analysis.html'>Risoe.BINfileData2RLum.Analysis</a></span>(<span class='no'>CWOSL.SAR.Data</span>, <span class='kw'>pos</span><span class='kw'>=</span><span class='fl'>1</span>)

<span class='co'>##(c) Grep curves and exclude the last two (one TL and one IRSL)</span>
<span class='no'>object</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_RLum.html'>get_RLum</a></span>(<span class='no'>object</span>, <span class='kw'>record.id</span> <span class='kw'>=</span> <span class='fu'>c</span>(-<span class='fl'>29</span>,-<span class='fl'>30</span>))

<span class='co'>##(d) Define new sequence structure and set new RLum.Analysis object</span>
<span class='no'>sequence.structure</span>  <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>4</span>)
<span class='no'>sequence.structure</span> <span class='kw'>&lt;-</span> <span class='fu'>as.vector</span>(<span class='fu'>sapply</span>(<span class='fu'>seq</span>(<span class='fl'>0</span>,<span class='fu'>length</span>(<span class='no'>object</span>)-<span class='fl'>1</span>,<span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>4</span>),
                                       <span class='kw'>function</span>(<span class='no'>x</span>){<span class='no'>sequence.structure</span> + <span class='no'>x</span>}))

<span class='no'>object</span> <span class='kw'>&lt;-</span>  <span class='fu'>sapply</span>(<span class='fl'>1</span>:<span class='fu'>length</span>(<span class='no'>sequence.structure</span>), <span class='kw'>function</span>(<span class='no'>x</span>){

  <span class='no'>object</span><span class='kw'>[[</span><span class='no'>sequence.structure</span>[<span class='no'>x</span>]]]

})

<span class='no'>object</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_RLum.html'>set_RLum</a></span>(<span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"RLum.Analysis"</span>, <span class='kw'>records</span> <span class='kw'>=</span> <span class='no'>object</span>, <span class='kw'>protocol</span> <span class='kw'>=</span> <span class='st'>"pIRIR"</span>)

<span class='co'>##(2) Perform pIRIR analysis (for this example with quartz OSL data!)</span>
<span class='co'>## Note: output as single plots to avoid problems with this example</span>
<span class='no'>results</span> <span class='kw'>&lt;-</span> <span class='fu'>analyse_pIRIRSequence</span>(<span class='no'>object</span>,
     <span class='kw'>signal.integral.min</span> <span class='kw'>=</span> <span class='fl'>1</span>,
     <span class='kw'>signal.integral.max</span> <span class='kw'>=</span> <span class='fl'>2</span>,
     <span class='kw'>background.integral.min</span> <span class='kw'>=</span> <span class='fl'>900</span>,
     <span class='kw'>background.integral.max</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
     <span class='kw'>fit.method</span> <span class='kw'>=</span> <span class='st'>"EXP"</span>,
     <span class='kw'>sequence.structure</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"TL"</span>, <span class='st'>"pseudoIRSL1"</span>, <span class='st'>"pseudoIRSL2"</span>),
     <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Pseudo pIRIR data set based on quartz OSL"</span>,
     <span class='kw'>plot.single</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in plot.new(): figure margins too large</span></div><div class='input'>

##(3) Perform pIRIR analysis (for this example with quartz OSL data!)
## Alternative for PDF output, uncomment and complete for usage
</div><span class='co'># NOT RUN {</span>
<span class='fu'>pdf</span>(<span class='kw'>file</span> <span class='kw'>=</span> <span class='st'>"..."</span>, <span class='kw'>height</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>width</span> <span class='kw'>=</span> <span class='fl'>15</span>)
  <span class='no'>results</span> <span class='kw'>&lt;-</span> <span class='fu'>analyse_pIRIRSequence</span>(<span class='no'>object</span>,
         <span class='kw'>signal.integral.min</span> <span class='kw'>=</span> <span class='fl'>1</span>,
         <span class='kw'>signal.integral.max</span> <span class='kw'>=</span> <span class='fl'>2</span>,
         <span class='kw'>background.integral.min</span> <span class='kw'>=</span> <span class='fl'>900</span>,
         <span class='kw'>background.integral.max</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
         <span class='kw'>fit.method</span> <span class='kw'>=</span> <span class='st'>"EXP"</span>,
         <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Pseudo pIRIR data set based on quartz OSL"</span>)

  <span class='fu'>dev.off</span>()
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#function-version">Function version</a></li>

      <li><a href="#how-to-cite">How to cite</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Sebastian Kreutzer, IRAMAT-CRP2A, Universite Bordeaux Montaigne
(France)
 R Luminescence Package Team
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
