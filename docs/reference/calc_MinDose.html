<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999)
to a given De distribution — calc_MinDose • Luminescence</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Luminescence</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/HowTo_analyse_Al2O3.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.7.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999)
to a given De distribution</h1>
    </div>

    
    <p>Function to fit the (un-)logged three or four parameter minimum dose model
(MAM-3/4) to De data.</p>
    

    <pre class="usage"><span class='fu'>calc_MinDose</span>(<span class='no'>data</span>, <span class='no'>sigmab</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>par</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>init.values</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>multicore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p><a href='RLum.Results-class.html'>RLum.Results</a> or data.frame (<strong>required</strong>):
for data.frame: two columns with De <code>(data[ ,1])</code> and De error <code>(data[ ,2])</code>.</p></td>
    </tr>
    <tr>
      <th>sigmab</th>
      <td><p>numeric (<strong>required</strong>):
additional spread in De values.
This value represents the expected overdispersion in the data should the sample be
well-bleached (Cunningham &amp; Walling 2012, p. 100).
<strong>NOTE</strong>: For the logged model (<code>log = TRUE</code>) this value must be
a fraction, e.g. 0.2 (= 20 %). If the un-logged model is used (<code>log = FALSE</code>),
sigmab must be provided in the same absolute units of the De values (seconds or Gray).
See details.</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>logical (<em>with default</em>):
fit the (un-)logged minimum dose model to De data.</p></td>
    </tr>
    <tr>
      <th>par</th>
      <td><p>numeric (<em>with default</em>):
apply the 3- or 4-parametric minimum age model (<code>par=3</code> or <code>par=4</code>). The MAM-3 is
used by default.</p></td>
    </tr>
    <tr>
      <th>bootstrap</th>
      <td><p>logical (<em>with default</em>):
apply the recycled bootstrap approach of Cunningham &amp; Wallinga (2012).</p></td>
    </tr>
    <tr>
      <th>init.values</th>
      <td><p>numeric (<em>optional</em>):
a named list with starting values for gamma, sigma, p0 and mu
(e.g. <code>list(gamma=100, sigma=1.5, p0=0.1, mu=100)</code>). If no values are provided reasonable values
are tried to be estimated from the data.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>logical (<em>with default</em>):
the confidence level required (defaults to 0.95).</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>logical (<em>with default</em>):
plot output (<code>TRUE</code>/<code>FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>multicore</th>
      <td><p>logical (<em>with default</em>):
enable parallel computation of the bootstrap by creating a multicore SNOW cluster. Depending
on the number of available logical CPU cores this may drastically reduce
the computation time. Note that this option is highly experimental and may not
work on all machines. (<code>TRUE</code>/<code>FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(<em>optional</em>) further arguments for bootstrapping
(<code>bs.M, bs.N, bs.h, sigmab.sd</code>). See details for their usage.
Further arguments are</p><ul>
<li><p><code>verbose</code> to de-/activate console output (logical),</p></li>
<li><p><code>debug</code> for extended console output (logical) and</p></li>
<li><p><code>cores</code> (integer) to manually specify the number of cores to be used when <code>multicore=TRUE</code>.</p></li>
</ul></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a plot (<em>optional</em>) and terminal output. In addition an
<a href='RLum.Results-class.html'>RLum.Results</a> object is returned containing the
following elements:</p>
<dt>.$summary</dt><dd><p>data.frame summary of all relevant model results.</p></dd>
<dt>.$data</dt><dd><p>data.frame original input data</p></dd>
<dt>args</dt><dd><p>list used arguments</p></dd>
<dt>call</dt><dd><p>call the function call</p></dd>
<dt>.$mle</dt><dd><p>mle2 object containing the maximum log likelhood functions for all parameters</p></dd>
<dt>BIC</dt><dd><p>numeric BIC score</p></dd>
<dt>.$confint</dt><dd><p>data.frame confidence intervals for all parameters</p></dd>
<dt>.$profile</dt><dd><p>profile.mle2 the log likelihood profiles</p></dd>
<dt>.$bootstrap</dt><dd><p>list bootstrap results</p></dd>

The output should be accessed using the function get_RLum

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Parameters</strong></p>
<p>This model has four parameters:</p><table><tr><td>
<code>gamma</code>: </td>
<td> minimum dose on the log scale </td>
</tr><tr><td>
<code>mu</code>: </td>
<td> mean of the non-truncated normal distribution </td>
</tr><tr><td>
<code>sigma</code>: </td>
<td> spread in ages above the minimum </td>
</tr><tr><td>
<code>p0</code>: </td>
<td> proportion of grains at gamma </td>
</tr></table>
    <p>If <code>par=3</code> (default) the 3-parametric minimum age model is applied,
where <code>gamma=mu</code>. For <code>par=4</code> the 4-parametric model is applied instead.
    <strong>(Un-)logged model</strong></p>
<p>In the original version of the minimum dose model, the basic data are the natural
logarithms of the De estimates and relative standard errors of the De
estimates. The value for <code>sigmab</code> must be provided as a ratio
(e.g, 0.2 for 20 %). This model will be applied if <code>log = TRUE</code>.</p>
<p>If <code>log=FALSE</code>, the modified un-logged model will be applied instead. This
has essentially the same form as the original version.  <code>gamma</code> and
<code>sigma</code> are in Gy and <code>gamma</code> becomes the minimum true dose in the
population.
<strong>Note</strong> that the un-logged model requires <code>sigmab</code> to be in the same
absolute unit as the provided De values (seconds or Gray).</p>
<p>While the original (logged) version of the mimimum dose
model may be appropriate for most samples (i.e. De distributions), the
modified (un-logged) version is specially designed for modern-age and young
samples containing negative, zero or near-zero De estimates (Arnold et al.
2009, p. 323).
    <strong>Initial values &amp; boundaries</strong></p>
<p>The log likelihood calculations use the nlminb function for box-constrained
optimisation using PORT routines.  Accordingly, initial values for the four
parameters can be specified via <code>init.values</code>. If no values are
provided for <code>init.values</code> reasonable starting values are estimated
from the input data.  If the final estimates of <em>gamma</em>, <em>mu</em>,
<em>sigma</em> and <em>p0</em> are totally off target, consider providing custom
starting values via <code>init.values</code>.
In contrast to previous versions of this function the boundaries for the
individual model parameters are no longer required to be explicitly specified.
If you want to override the default boundary values use the arguments
<code>gamma.lower</code>, <code>gamma.upper</code>, <code>sigma.lower</code>, <code>sigma.upper</code>, <code>p0.lower</code>, <code>p0.upper</code>,
<code>mu.lower</code> and <code>mu.upper</code>.
    <strong>Bootstrap</strong></p>
<p>When <code>bootstrap=TRUE</code> the function applies the bootstrapping method as
described in Wallinga &amp; Cunningham (2012). By default, the minimum age model
produces 1000 first level and 3000 second level bootstrap replicates
(actually, the number of second level bootstrap replicates is three times
the number of first level replicates unless specified otherwise).  The
uncertainty on sigmab is 0.04 by default. These values can be changed by
using the arguments <code>bs.M</code> (first level replicates), <code>bs.N</code>
(second level replicates) and <code>sigmab.sd</code> (error on sigmab). With
<code>bs.h</code> the bandwidth of the kernel density estimate can be specified.
By default, <code>h</code> is calculated as
    $$h = (2*\sigma_{DE})/\sqrt{n}$$
    <strong>Multicore support</strong></p>
<p>This function supports parallel computing and can be activated by <code>multicore=TRUE</code>.
By default, the number of available logical CPU cores is determined
automatically, but can be changed with <code>cores</code>. The multicore support
is only available when <code>bootstrap=TRUE</code> and spawns <code>n</code> R instances
for each core to get MAM estimates for each of the N and M boostrap
replicates. Note that this option is highly experimental and may or may not
work for your machine. Also the performance gain increases for larger number
of bootstrap replicates. Also note that with each additional core and hence
R instance and depending on the number of bootstrap replicates the memory
usage can significantly increase. Make sure that memory is always availabe,
otherwise there will be a massive perfomance hit.
    <strong>Likelihood profiles</strong></p>
<p>The likelihood profiles are generated and plotted by the <code>bbmle</code> package.
The profile likelihood plots look different to ordinary profile likelihood as</p>
<p>"<code>[...]</code> the plot method for likelihood profiles displays the square root of
the the deviance difference (twice the difference in negative log-likelihood from
the best fit), so it will be V-shaped for cases where the quadratic approximation
works well <code>[...]</code>." (Bolker 2016).</p>
<p>For more details on the profile likelihood
calculations and plots please see the vignettes of the <code>bbmle</code> package
(also available here: <a href='https://CRAN.R-project.org/package=bbmle'>https://CRAN.R-project.org/package=bbmle</a>).</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The default starting values for <em>gamma</em>, <em>mu</em>, <em>sigma</em>
and <em>p0</em> may only be appropriate for some De data sets and may need to
be changed for other data. This is especially true when the un-logged
version is applied. 
Also note that all R warning messages are suppressed
when running this function. If the results seem odd consider re-running the
model with <code>debug=TRUE</code> which provides extended console output and
forwards all internal warning messages.</p>
    
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.4.4 (2018-01-21 17:22:38)</p>
    
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Burow, C. (2018). calc_MinDose(): Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999) to a given De distribution. Function version 0.4.4. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J. (2018). Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.8.0. https://CRAN.R-project.org/package=Luminescence</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Arnold, L.J., Roberts, R.G., Galbraith, R.F. &amp; DeLong, S.B.,
2009. A revised burial dose estimation procedure for optical dating of young
and modern-age sediments. Quaternary Geochronology 4, 306-325.</p>
<p>Galbraith, R.F. &amp; Laslett, G.M., 1993. Statistical models for mixed fission
track ages. Nuclear Tracks Radiation Measurements 4, 459-470.</p>
<p>Galbraith, R.F., Roberts, R.G., Laslett, G.M., Yoshida, H. &amp; Olley, J.M.,
1999. Optical dating of single grains of quartz from Jinmium rock shelter,
northern Australia. Part I: experimental design and statistical models.
Archaeometry 41, 339-364.</p>
<p>Galbraith, R.F., 2005. Statistics for
Fission Track Analysis, Chapman &amp; Hall/CRC, Boca Raton.</p>
<p>Galbraith, R.F. &amp; Roberts, R.G., 2012. Statistical aspects of equivalent dose and error
calculation and display in OSL dating: An overview and some recommendations.
Quaternary Geochronology 11, 1-27.</p>
<p>Olley, J.M., Roberts, R.G., Yoshida, H., Bowler, J.M., 2006. Single-grain optical dating of grave-infill
associated with human burials at Lake Mungo, Australia. Quaternary Science
Reviews 25, 2469-2474.
    <strong>Further reading</strong></p>
<p>Arnold, L.J. &amp; Roberts, R.G., 2009. Stochastic modelling of multi-grain equivalent dose
(De) distributions: Implications for OSL dating of sediment mixtures.
Quaternary Geochronology 4, 204-230.</p>
<p>Bolker, B., 2016. Maximum likelihood estimation analysis with the bbmle package.
In: Bolker, B., R Development Core Team, 2016. bbmle: Tools for General Maximum Likelihood Estimation.
R package version 1.0.18. <a href='https://CRAN.R-project.org/package=bbmle'>https://CRAN.R-project.org/package=bbmle</a></p>
<p>Bailey, R.M. &amp; Arnold, L.J., 2006. Statistical modelling of single grain quartz De distributions and an
assessment of procedures for estimating burial dose. Quaternary Science
Reviews 25, 2475-2502.</p>
<p>Cunningham, A.C. &amp; Wallinga, J., 2012. Realizing the potential of fluvial archives using robust OSL chronologies.
Quaternary Geochronology 12, 98-106.</p>
<p>Rodnight, H., Duller, G.A.T., Wintle, A.G. &amp; Tooth, S., 2006. Assessing the reproducibility and accuracy
of optical dating of fluvial deposits.  Quaternary Geochronology 1, 109-120.</p>
<p>Rodnight, H., 2008. How many equivalent dose values are needed to
obtain a reproducible distribution?. Ancient TL 26, 3-10.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><a href='calc_CentralDose.html'>calc_CentralDose</a>, <a href='calc_CommonDose.html'>calc_CommonDose</a>, <a href='calc_FiniteMixture.html'>calc_FiniteMixture</a>,
<a href='calc_FuchsLang2001.html'>calc_FuchsLang2001</a>, <a href='calc_MaxDose.html'>calc_MaxDose</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load example data</span>
<span class='fu'>data</span>(<span class='no'>ExampleData.DeValues</span>, <span class='kw'>envir</span> <span class='kw'>=</span> <span class='fu'>environment</span>())

<span class='co'># (1) Apply the minimum age model with minimum required parameters.</span>
<span class='co'># By default, this will apply the un-logged 3-parametric MAM.</span>
<span class='fu'>calc_MinDose</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ExampleData.DeValues</span>$<span class='no'>CA1</span>, <span class='kw'>sigmab</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)</div><div class='output co'>#&gt; 
#&gt; ----------- meta data -----------
#&gt;   n par sigmab logged      Lmax      BIC
#&gt;  62   3    0.1   TRUE -43.57969 106.4405
#&gt; 
#&gt; --- final parameter estimates ---
#&gt;  gamma sigma   p0 mu
#&gt;   3.54  0.73 0.01  0
#&gt; 
#&gt; ------ confidence intervals -----
#&gt;       2.5 % 97.5 %
#&gt; gamma  3.38   3.67
#&gt; sigma  0.57   0.94
#&gt; p0       NA   0.11
#&gt; 
#&gt; ------ De (asymmetric error) -----
#&gt;     De lower upper
#&gt;  34.32 29.38 39.38
#&gt; 
#&gt; ------ De (symmetric error) -----
#&gt;     De error
#&gt;  34.32  2.55</div><div class='img'><img src='calc_MinDose-7.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># (2) Re-run the model, but save results to a variable and turn</span>
<span class='co'># plotting of the log-likelihood profiles off.</span>
<span class='no'>mam</span> <span class='kw'>&lt;-</span> <span class='fu'>calc_MinDose</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ExampleData.DeValues</span>$<span class='no'>CA1</span>,
                    <span class='kw'>sigmab</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
                    <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># Show structure of the RLum.Results object</span>
<span class='no'>mam</span>

<span class='co'># Show summary table that contains the most relevant results</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_RLum.html'>get_RLum</a></span>(<span class='no'>mam</span>, <span class='st'>"summary"</span>)
<span class='no'>res</span>

<span class='co'># Plot the log likelihood profiles retroactively, because before</span>
<span class='co'># we set plot = FALSE</span>
<span class='fu'><a href='plot_RLum.html'>plot_RLum</a></span>(<span class='no'>mam</span>)

<span class='co'># Plot the dose distribution in an abanico plot and draw a line</span>
<span class='co'># at the minimum dose estimate</span>
<span class='fu'><a href='plot_AbanicoPlot.html'>plot_AbanicoPlot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ExampleData.DeValues</span>$<span class='no'>CA1</span>,
                 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"3-parameter Minimum Age Model"</span>,
                 <span class='kw'>line</span> <span class='kw'>=</span> <span class='no'>mam</span>,<span class='kw'>polygon.col</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
                 <span class='kw'>hist</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                 <span class='kw'>rug</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                 <span class='kw'>summary</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"n"</span>, <span class='st'>"mean"</span>, <span class='st'>"mean.weighted"</span>, <span class='st'>"median"</span>, <span class='st'>"in.ci"</span>),
                 <span class='kw'>centrality</span> <span class='kw'>=</span> <span class='no'>res</span>$<span class='no'>de</span>,
                 <span class='kw'>line.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>,
                 <span class='kw'>grid.col</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
                 <span class='kw'>line.label</span> <span class='kw'>=</span> <span class='fu'>paste0</span>(<span class='fu'>round</span>(<span class='no'>res</span>$<span class='no'>de</span>, <span class='fl'>1</span>), <span class='st'>"\U00B1"</span>,
                                     <span class='fu'>round</span>(<span class='no'>res</span>$<span class='no'>de_err</span>, <span class='fl'>1</span>), <span class='st'>" Gy"</span>),
                 <span class='kw'>bw</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
                 <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'>c</span>(-<span class='fl'>25</span>, <span class='fl'>18</span>),
                 <span class='kw'>summary.pos</span> <span class='kw'>=</span> <span class='st'>"topleft"</span>,
                 <span class='kw'>mtext</span> <span class='kw'>=</span> <span class='fu'>bquote</span>(<span class='st'>"Parameters: "</span> ~
                                  <span class='no'>sigma</span>[<span class='no'>b</span>] <span class='kw'>==</span> <span class='fu'>.</span>(<span class='fu'><a href='get_RLum.html'>get_RLum</a></span>(<span class='no'>mam</span>, <span class='st'>"args"</span>)$<span class='no'>sigmab</span>) ~ <span class='st'>", "</span> ~
                                  <span class='no'>gamma</span> <span class='kw'>==</span> <span class='fu'>.</span>(<span class='fu'>round</span>(<span class='fu'>log</span>(<span class='no'>res</span>$<span class='no'>de</span>), <span class='fl'>1</span>)) ~ <span class='st'>", "</span> ~
                                  <span class='no'>sigma</span> <span class='kw'>==</span> <span class='fu'>.</span>(<span class='fu'>round</span>(<span class='no'>res</span>$<span class='no'>sig</span>, <span class='fl'>1</span>)) ~ <span class='st'>", "</span> ~
                                  <span class='no'>rho</span> <span class='kw'>==</span> <span class='fu'>.</span>(<span class='fu'>round</span>(<span class='no'>res</span>$<span class='no'>p0</span>, <span class='fl'>2</span>))))



<span class='co'># (3) Run the minimum age model with bootstrap</span>
<span class='co'># NOTE: Bootstrapping is computationally intensive</span>
<span class='co'># (3.1) run the minimum age model with default values for bootstrapping</span>
<span class='fu'>calc_MinDose</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ExampleData.DeValues</span>$<span class='no'>CA1</span>,
             <span class='kw'>sigmab</span> <span class='kw'>=</span> <span class='fl'>0.15</span>,
             <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># (3.2) Bootstrap control parameters</span>
<span class='no'>mam</span> <span class='kw'>&lt;-</span> <span class='fu'>calc_MinDose</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ExampleData.DeValues</span>$<span class='no'>CA1</span>,
                    <span class='kw'>sigmab</span> <span class='kw'>=</span> <span class='fl'>0.15</span>,
                    <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                    <span class='kw'>bs.M</span> <span class='kw'>=</span> <span class='fl'>300</span>,
                    <span class='kw'>bs.N</span> <span class='kw'>=</span> <span class='fl'>500</span>,
                    <span class='kw'>bs.h</span> <span class='kw'>=</span> <span class='fl'>4</span>,
                    <span class='kw'>sigmab.sd</span> <span class='kw'>=</span> <span class='fl'>0.06</span>,
                    <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># Plot the results</span>
<span class='fu'><a href='plot_RLum.html'>plot_RLum</a></span>(<span class='no'>mam</span>)

<span class='co'># save bootstrap results in a separate variable</span>
<span class='no'>bs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_RLum.html'>get_RLum</a></span>(<span class='no'>mam</span>, <span class='st'>"bootstrap"</span>)

<span class='co'># show structure of the bootstrap results</span>
<span class='fu'>str</span>(<span class='no'>bs</span>, <span class='kw'>max.level</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>give.attr</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># print summary of minimum dose and likelihood pairs</span>
<span class='fu'>summary</span>(<span class='no'>bs</span>$<span class='no'>pairs</span>$<span class='no'>gamma</span>)

<span class='co'># Show polynomial fits of the bootstrap pairs</span>
<span class='no'>bs</span>$<span class='no'>poly.fits</span>$<span class='no'>poly.three</span>

<span class='co'># Plot various statistics of the fit using the generic plot() function</span>
<span class='fu'>par</span>(<span class='kw'>mfcol</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'>plot</span>(<span class='no'>bs</span>$<span class='no'>poly.fits</span>$<span class='no'>poly.three</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># Show the fitted values of the polynomials</span>
<span class='fu'>summary</span>(<span class='no'>bs</span>$<span class='no'>poly.fits</span>$<span class='no'>poly.three</span>$<span class='no'>fitted.values</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#function-version">Function version</a></li>

      <li><a href="#how-to-cite">How to cite</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Christoph Burow, University of Cologne (Germany) 
Based on a rewritten S script of Rex Galbraith, 2010 
The bootstrap approach is based on a rewritten MATLAB script of Alastair Cunningham. 
Alastair Cunningham is thanked for his help in implementing and cross-checking the code.
 R Luminescence Package Team
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
